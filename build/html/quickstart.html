<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Getting started &mdash; ViUR Server 1.1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/mbtemplate.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="ViUR Server 1.1.0 documentation" href="index.html" />
    <link rel="next" title="Bones" href="bones/bones_api.html" />
    <link rel="prev" title="Data Consistency" href="consistency.html" />
   
  
  <link rel="icon" href="_static/favicon.png" type="image/png"/>
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="getting-started">
<h1>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<p>Before getting started with ViUR, there are some pitfalls we should clarify up front.
First, ViUR is <strong>not</strong> a content management system. It offers you the <em>building blocks to build one</em> in no time.
But again, it&#8217;s not a ready to use cms. Second, you&#8217;ll need to understand the basic principle of building applications
with ViUR. With ViUR, you&#8217;ll merge a model (a <em>skeleton</em> in ViURs language) and an application
(like list/tree/hierarchy/singleton) into a module. On this level access-rights and module-specific code are added and
at least one output renderer is attached.</p>
<blockquote>
<div><div class="align-center figure" id="id1">
<img alt="Overview of an example module" src="_images/gettingstarted1.jpeg" />
<p class="caption"><span class="caption-text">Overview of an example module</span></p>
</div>
</div></blockquote>
<dl class="docutils">
<dt>So whats happening here?</dt>
<dd><p class="first">1) We define a model named &#8216;news&#8217;.
Each entry will have a required <em>name</em> and an optional <em>descr</em> (description).</p>
<blockquote>
<div>This model <em>must</em> be defined in your &#8216;models&#8217; folder and <em>should</em> be in a file called &#8216;news.py&#8217;.</div></blockquote>
<p>2) We use the &#8216;List&#8217; application to handle our data. So our news will be stored in a flat list with built-in filtering
and sorting possibilities.</p>
<p>3)/8) We (explicitly) attach the jinja2 renderer to our module. As the jinja2 renderer is currently the default,
there is no need to do this explicitly (ViUR will enable the admin and the jinja2 renderer by default. All other
renderers have to be named here!).</p>
<dl class="docutils">
<dt>4) We define the actual module. It <em>must</em> be in your &#8216;modules&#8217; folder and <em>should</em> be in a file called &#8216;news.py&#8217;.</dt>
<dd>We define a single class called &#8216;News&#8217;. That name is used to determine which skeleton (model) should be attached to
this module, so it must be named exactly as the kindName used in the skeleton (Override the function &#8216;_resolveSkel&#8217;
if you need to change this behaviour).</dd>
</dl>
<p>5) Within this module, we declare which templates to use. This module would use &#8216;news_list.tpl&#8217; inside your &#8216;html&#8217; folder
for rendering /news/list and &#8216;news_view.html&#8217; for /news/view/some_news_id.</p>
<p>6) We override the default access restriction for view (default: deny everything except for admins). We allow everyone
to view all news present in the system.</p>
<p class="last">7) Add an adminInfo. If this dictionary is present, this module will show up in your admin/vi interface. Setting this
to None will hide this module from your admin interfaces.</p>
</dd>
</dl>
<p>In the following short step-by-step guide we create our first custom module.</p>
<blockquote>
<div><ul class="simple">
<li>Module name: News</li>
<li>Application: List (Flat Data)</li>
<li>Entities consist of Name and Description (Optional)</li>
<li>List is public (everyone can see entries)</li>
<li>Only admins can add or edit entries (ViURs default)</li>
</ul>
</div></blockquote>
<p>First step: Define the data-model. We define an Entity &#8216;news&#8217;, which contains two properties: name and description.
Name is a short String (&lt; 255 Chars); Description a longer, optional Text. This file should be named &#8216;news.py&#8217; and
<em>must</em> be in your &#8216;models&#8217; folder.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">from</span> <span class="nn">server.skeleton</span> <span class="kn">import</span> <span class="n">Skeleton</span>
<span class="kn">from</span> <span class="nn">server.bones</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">NewsSkel</span><span class="p">(</span> <span class="n">Skeleton</span> <span class="p">):</span> <span class="c1">#Datamodel for this modul:</span>
    <span class="n">kindName</span> <span class="o">=</span> <span class="s2">&quot;news&quot;</span> <span class="c1">#Save entities to the collection news</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">stringBone</span><span class="p">(</span>  <span class="n">descr</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span> <span class="p">)</span>
    <span class="n">descr</span> <span class="o">=</span> <span class="n">textBone</span><span class="p">(</span>  <span class="n">descr</span><span class="o">=</span><span class="s2">&quot;Description&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">False</span> <span class="p">)</span>
</pre></div>
</div>
<p>Second step: Create the file &#8216;news.py&#8217; inside the &#8216;modules&#8217; folder of the application and  import the required application.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">from</span> <span class="nn">server.applications.list</span> <span class="kn">import</span> <span class="n">List</span>
</pre></div>
</div>
<p>Third step: Create a subclass from the &#8216;List&#8217; application and specify the required information for the admin tool.
If a module should be hidden from the admin, set adminInfo to None.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">News</span><span class="p">(</span> <span class="n">List</span> <span class="p">):</span>
    <span class="n">adminInfo</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;News&quot;</span><span class="p">,</span> <span class="c1">#Name of this module, as shown in Admin</span>
            <span class="s2">&quot;handler&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span>  <span class="c1">#Which handler to invoke</span>
            <span class="s2">&quot;icon&quot;</span><span class="p">:</span> <span class="s2">&quot;icons/modules/news.png&quot;</span><span class="p">,</span> <span class="c1">#Icon for this module</span>
            <span class="s2">&quot;filter&quot;</span><span class="p">:{</span><span class="s2">&quot;orderby&quot;</span><span class="p">:</span><span class="s2">&quot;creationdate&quot;</span><span class="p">},</span> <span class="c1">#Default filter for the admin (i.e. dont filter; just sort )</span>
            <span class="s2">&quot;columns&quot;</span><span class="p">:[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="c1"># Default set of columns visible in the admin</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>Fourth step: Define the access rights. In this example, we make the list publicly readable,
but changes are still restricted to administrators of the application.
If we don&#8217;t override this function, read access would be also restricted to administrators only.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">listFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rawfilter</span><span class="p">):</span>
    <span class="c1"># Accesscontrol: Let everyone view the contents</span>
    <span class="k">return</span><span class="p">(</span> <span class="n">rawfilter</span> <span class="p">)</span>
</pre></div>
</div>
<p>Fifth step: Register the module. This enables the application.
Simply list the module inside __init__.py in the &#8216;modules&#8217; folder.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">modules.news</span> <span class="kn">import</span> <span class="n">News</span> <span class="k">as</span> <span class="n">news</span>
</pre></div>
</div>
<p>The application is now active and can be administrated using your favorite admin interface.
However, there are no templates defined yet for data presentation in a webbrowser .</p>
<div class="section" id="create-a-template">
<h2>Create a template<a class="headerlink" href="#create-a-template" title="Permalink to this headline">¶</a></h2>
<p>The templates to use have to be registered in the module.
Add the following lines to the module class.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">viewTemplate</span> <span class="o">=</span> <span class="s2">&quot;news_view&quot;</span> <span class="c1">#Name of the template which displays *one* entry</span>
<span class="n">listTemplate</span> <span class="o">=</span> <span class="s2">&quot;news_list&quot;</span> <span class="c1">#Name of the template which displays several entries</span>
</pre></div>
</div>
<p>The whole module should now look like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">from</span> <span class="nn">server.applications.list</span> <span class="kn">import</span> <span class="n">List</span>

<span class="k">class</span> <span class="nc">News</span><span class="p">(</span><span class="n">List</span><span class="p">):</span>
   <span class="n">viewTemplate</span> <span class="o">=</span> <span class="s2">&quot;news_view&quot;</span> <span class="c1">#Name of the template which displayes *one* entry</span>
   <span class="n">listTemplate</span> <span class="o">=</span> <span class="s2">&quot;news_list&quot;</span> <span class="c1">#Name of the template which displayes several entries</span>

   <span class="n">adminInfo</span> <span class="o">=</span> <span class="p">{</span>  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;News&quot;</span><span class="p">,</span> <span class="c1">#Name of this modul, as shown in Admin</span>
        <span class="s2">&quot;handler&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span>  <span class="c1">#Which handler to invoke</span>
        <span class="s2">&quot;icon&quot;</span><span class="p">:</span> <span class="s2">&quot;icons/modules/news.png&quot;</span><span class="p">,</span> <span class="c1">#Icon for this modul</span>
        <span class="s2">&quot;filter&quot;</span><span class="p">:{</span><span class="s2">&quot;orderby&quot;</span><span class="p">:</span><span class="s2">&quot;creationdate&quot;</span><span class="p">},</span> <span class="c1">#Default filter for the admin (i.e. dont filter; just sort )</span>
        <span class="s2">&quot;coumns&quot;</span><span class="p">:[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="c1"># Default set of columns visible in the admin</span>
   <span class="p">}</span>

   <span class="k">def</span> <span class="nf">listFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rawfilter</span><span class="p">):</span>
       <span class="c1"># Accesscontrol: Let everyone view the contents</span>
       <span class="k">return</span><span class="p">(</span> <span class="n">rawfilter</span> <span class="p">)</span>
</pre></div>
</div>
<p>Now create the templates.
Possible layout for html/news_view.html:</p>
<div class="highlight-python"><div class="highlight"><pre>...
&lt;h1&gt;{{skel.name}}&lt;/h1&gt;
{{skel.descr}}
...
</pre></div>
</div>
<p>Possible layout for html/news_list.html:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;td&gt;Name&lt;/td&gt;
      &lt;td&gt;View&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  {% for skel in skellist %}
    &lt;tr&gt;
      &lt;td&gt;{{skel.name}}&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;/test/view/{{skel.id}}&quot;&gt;View more&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
  {% endfor %}
&lt;/table&gt;
</pre></div>
</div>
<p>Got it? Then dive deeper into ViUR, depending on whether you are a designer or a developer!</p>
</div>
<div class="section" id="examples-for-developers">
<h2>Examples for developers<a class="headerlink" href="#examples-for-developers" title="Permalink to this headline">¶</a></h2>
<div class="section" id="add-a-more-fine-grained-access-model">
<h3>Add a more fine grained access model<a class="headerlink" href="#add-a-more-fine-grained-access-model" title="Permalink to this headline">¶</a></h3>
<p>Often we need to distinguish between registered users and guests.
Step one: Add a new property to the &#8216;news&#8217; model.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">NewsSkel</span><span class="p">(</span> <span class="n">Skeleton</span> <span class="p">):</span> <span class="c1">#Datamodel for this modul:</span>
    <span class="n">kindName</span> <span class="o">=</span> <span class="s2">&quot;news&quot;</span> <span class="c1">#Save entities to the collection news</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">stringBone</span><span class="p">(</span>  <span class="n">descr</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span> <span class="p">)</span>
    <span class="n">descr</span> <span class="o">=</span> <span class="n">textBone</span><span class="p">(</span>  <span class="n">descr</span><span class="o">=</span><span class="s2">&quot;Descr&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">False</span> <span class="p">)</span>
    <span class="n">access</span> <span class="o">=</span> <span class="n">selectOneBone</span><span class="p">(</span><span class="n">descr</span><span class="o">=</span><span class="s2">&quot;Access&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;0&quot;</span><span class="p">:</span><span class="s2">&quot;Everyone&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span><span class="s2">&quot;Registered users&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">:</span><span class="s2">&quot;Admins Only&quot;</span><span class="p">},</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">indexed</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Step two: make the listFilter function aware of this</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">listFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rawfilter</span><span class="p">):</span>
    <span class="n">usr</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">getCurrentUser</span><span class="p">()</span> <span class="c1"># Is this request from an authenticated user?</span>
    <span class="k">if</span> <span class="n">usr</span> <span class="ow">and</span> <span class="n">usr</span><span class="p">[</span><span class="s2">&quot;access&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="s2">&quot;root&quot;</span> <span class="ow">in</span> <span class="n">usr</span><span class="p">[</span><span class="s2">&quot;access&quot;</span><span class="p">]:</span> <span class="c1"># Its an admin</span>
         <span class="k">return</span> <span class="n">rawfilter</span> <span class="c1"># Don&#39;t enforce any constrains here</span>
    <span class="k">if</span> <span class="n">usr</span><span class="p">:</span> <span class="c1"># Just a normal user</span>
         <span class="n">rawfilter</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;access &lt;=&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># Its a guest</span>
         <span class="n">rawfilter</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;access &lt;=&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rawfilter</span>
</pre></div>
</div>
<p>Please note that this doesn&#8217;t need any changes inside the template. The template would now automatically receive only
the entries the current user is allowed to see.</p>
</div>
<div class="section" id="switching-to-hierarchical-data">
<h3>Switching to hierarchical Data<a class="headerlink" href="#switching-to-hierarchical-data" title="Permalink to this headline">¶</a></h3>
<p>If a flat datastructure doesn&#8217;t fit your needs anymore, its easy to switch to a hierarchical structure.
The following code shows the modified module, which utilizes the hierarchy application to store its data.</p>
<p>Update your skeleton to derive from server.applications.hierarchy.HierarchySkel</p>
<div class="highlight-python"><div class="highlight"><pre># -*- coding: utf-8 -*-
   from server.bones import *
   from server.applications.hierarchy import HierarchySkel


   class NewsSkel( HierarchySkel ): #Datamodel for this modul:
       kindName = &quot;news&quot; #Save entities to the collection news
       name = stringBone(  descr=&quot;Name&quot;, required=True )
       descr = textBone(  descr=&quot;Descr&quot;, required=False )
       access = selectOneBone(descr=&quot;Access&quot;, values={&quot;0&quot;:&quot;Everyone&quot;, &quot;1&quot;:&quot;Registered users&quot;, &quot;2&quot;:&quot;Admins Only&quot;}, required=True, indexed=True)
</pre></div>
</div>
<p>Then update your application to derive from server.applications.hierarchy.Hierarchy and override the corresponding
canAccess methods:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">from</span> <span class="nn">server.applications.hierarchy</span> <span class="kn">import</span> <span class="n">Hierarchy</span><span class="p">,</span> <span class="n">HierarchySkel</span>

<span class="k">class</span> <span class="nc">News</span><span class="p">(</span><span class="n">Hierarchy</span><span class="p">):</span>
   <span class="n">viewTemplate</span> <span class="o">=</span> <span class="s2">&quot;news_view&quot;</span> <span class="c1">#Name of the template which displayes *one* entry</span>
   <span class="n">listTemplate</span> <span class="o">=</span> <span class="s2">&quot;news_list&quot;</span> <span class="c1">#Name of the template which displayes several entries</span>

   <span class="n">adminInfo</span> <span class="o">=</span> <span class="p">{</span>  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;News&quot;</span><span class="p">,</span> <span class="c1">#Name of this modul, as shown in Admin</span>
        <span class="s2">&quot;handler&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span>  <span class="c1">#Which handler to invoke</span>
        <span class="s2">&quot;icon&quot;</span><span class="p">:</span> <span class="s2">&quot;icons/modules/news.png&quot;</span><span class="p">,</span> <span class="c1">#Icon for this modul</span>
        <span class="s2">&quot;filter&quot;</span><span class="p">:{</span><span class="s2">&quot;orderby&quot;</span><span class="p">:</span><span class="s2">&quot;creationdate&quot;</span><span class="p">},</span> <span class="c1">#Default filter for the admin (i.e. dont filter; just sort )</span>
        <span class="s2">&quot;coumns&quot;</span><span class="p">:[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="c1"># Default set of columns visible in the admin</span>
   <span class="p">}</span>

<span class="k">def</span> <span class="nf">getAvailableRootNodes</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">):</span>
    <span class="c1"># We only want one RootNode per Application</span>
    <span class="n">repo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensureOwnModulRootNode</span><span class="p">()</span>
    <span class="k">return</span><span class="p">(</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">u&quot;Test&quot;</span><span class="p">,</span> <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="n">repo</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">urlsafe</span><span class="p">()</span> <span class="p">}]</span> <span class="p">)</span>

<span class="k">def</span> <span class="nf">canView</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="nb">id</span> <span class="p">):</span>
    <span class="c1">#Anybody can view every entry</span>
    <span class="k">return</span><span class="p">(</span> <span class="bp">True</span> <span class="p">)</span>

<span class="k">def</span> <span class="nf">canList</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">parent</span> <span class="p">):</span>
    <span class="c1">#Anybody can browse a node</span>
    <span class="k">return</span><span class="p">(</span> <span class="bp">True</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-custom-functions">
<h3>Adding custom functions<a class="headerlink" href="#adding-custom-functions" title="Permalink to this headline">¶</a></h3>
<p>Adding custom functions to an application is easy in ViUR.
You could simply extend your News-Class (add a function) and mark it with <em>&#64;exposed</em>. All functions marked with &#64;exposed
are directly accessible from outside. So if you have something like</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">from</span> <span class="nn">server.applications.list</span> <span class="kn">import</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">server</span> <span class="kn">import</span> <span class="n">exposed</span>

<span class="k">class</span> <span class="nc">News</span><span class="p">(</span><span class="n">List</span><span class="p">):</span>
    <span class="n">viewTemplate</span> <span class="o">=</span> <span class="s2">&quot;news_view&quot;</span> <span class="c1">#Name of the template which displayes *one* entry</span>
    <span class="n">listTemplate</span> <span class="o">=</span> <span class="s2">&quot;news_list&quot;</span> <span class="c1">#Name of the template which displayes several entries</span>

    <span class="nd">@exposed</span>
    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">u&quot;Hello world!&quot;</span>

    <span class="o">....</span>
</pre></div>
</div>
<p>your function &#8216;test&#8217; would be accessible under the url &#8220;/news/test&#8221;.</p>
<p>It is possible to define one function as the default entry point (accessible under &#8220;/&#8221;). For this,
create a <em>module</em> &#8220;index.py&#8221; and put the following code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">from</span> <span class="nn">server</span> <span class="kn">import</span> <span class="n">exposed</span>

<span class="k">class</span> <span class="nc">Index</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span> <span class="n">index</span><span class="p">,</span> <span class="bp">self</span> <span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

    <span class="nd">@exposed</span>
    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span> <span class="p">):</span>
        <span class="k">return</span> <span class="s2">u&quot;Hello world!&quot;</span>

<span class="n">Index</span><span class="o">.</span><span class="n">jinja2</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p>All modules (as well as models) need to be included in the __init__.py of that folder. So for your Index module you&#8217;ll need
to include the following:</p>
<blockquote class="last">
<div><div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">modules.index</span> <span class="kn">import</span> <span class="n">Index</span> <span class="k">as</span> <span class="n">index</span>
</pre></div>
</div>
</div></blockquote>
</div>
<p>There are two ways to access the database.
For pure custom code you can use the lightweight dictionary-based API:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">server</span> <span class="kn">import</span> <span class="n">db</span>

<span class="c1"># Create a new entry</span>
<span class="n">entry</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="s2">&quot;news&quot;</span><span class="p">)</span>
<span class="n">entry</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">u&quot;Hello world!&quot;</span>
<span class="n">newKey</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Put</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

<span class="c1"># Fetch entries from the database</span>
<span class="n">entry</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Get</span><span class="p">(</span><span class="n">newKey</span><span class="p">)</span> <span class="c1"># Get the entry stored under key *newKey*</span>
<span class="n">entries</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span><span class="s2">&quot;news&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span> <span class="c1"># Fetch up to 99 entries from the datastore</span>
</pre></div>
</div>
<p>If you want to access data for which a skeleton is defined, it is highly recommended to use <em>only</em> the skeleton-API while
working with those data. Corruptions might occur otherwise.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">models.news</span> <span class="kn">import</span> <span class="n">NewsSkel</span>

<span class="c1"># Create a new entry</span>
<span class="n">skel</span> <span class="o">=</span> <span class="n">NewsSkel</span><span class="p">()</span>
<span class="n">skel</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s2">u&quot;Hello world!&quot;</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">skel</span><span class="o">.</span><span class="n">toDB</span><span class="p">()</span>

<span class="c1"># Fetch entries from the database</span>
<span class="n">skel</span> <span class="o">=</span> <span class="n">NewsSkel</span><span class="p">()</span>
<span class="n">skel</span><span class="o">.</span><span class="n">fromDB</span><span class="p">(</span><span class="n">newKey</span><span class="p">)</span>
<span class="n">skellist</span> <span class="o">=</span>  <span class="n">NewsSkel</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span> <span class="c1"># Fetch up to 99 entries from the datastore</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="examples-for-designers-frontend-developers">
<h2>Examples for designers / frontend developers<a class="headerlink" href="#examples-for-designers-frontend-developers" title="Permalink to this headline">¶</a></h2>
<p>As a template designer, you can focus on providing a good user experience and don&#8217;t have to bother about things like
access control. Do you need to render a list? You&#8217;ll receive the global variable <em>skellist</em>:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;ol&gt;
    {% for skel in skellist %}
        &lt;li&gt;{{ skel.name }}&lt;/li&gt;
    {% endfor %}
&lt;/ol&gt;
</pre></div>
</div>
<p>If you&#8217;re inside a view (displaying only one item), you&#8217;ll receive <em>skel</em> instad:</p>
<div class="highlight-python"><div class="highlight"><pre>Name: {{skel.name}}
</pre></div>
</div>
<p>Static content like css or images can be included by dropping it into the <em>static</em> directory of your application. It will be available
under the url /static/.</p>
<p>Do you need two or more templates for the same thing? Use the <em>style</em> parameter. If you access
/news/list?style=teststyle, ViUR will first try to load the template news_list_teststyle.html. If it does exist, this file
will be used, otherwise ViUR loads the default template news_list.html and pass the global variable style set to &#8220;teststyle&#8221;.</p>
<p>Do you want to embed data from a different module into the current template? You can either embed a fully rendered template by
calling <em>execRequest</em> or you can fetch the data by yourself and prepare output accordingly.</p>
<div class="highlight-python"><div class="highlight"><pre>{{ execRequest(&quot;news/list&quot;, style=&quot;embed&quot;) }} {# Will call /news/list?style=embed and insert the result here #}
{% set newsList = getList(&quot;news&quot;) %} {# Fetch a list of news and assign the resulting skellist to newsList #}
{% for news in newsList %}
    {{ news.name }}
{% endfor %}
</pre></div>
</div>
<p>Do you need the next page of list? Just append/update the cursor sent along with the request.</p>
<div class="highlight-python"><div class="highlight"><pre>{% for skel in skellist %}
    {{ skel.name }}
{% endfor %}

&lt;a href=&quot;{{ updateUrl(cursor=skellist.cursor) }}&quot;&gt;Next page&lt;/a&gt;
</pre></div>
</div>
<p>SEO friendly URLs? Instead of pointing views to <em>/news/view/{{skel.id}}</em>, you can use something like
<em>/news/view/{{skel.id|shortKey}}/{{skel.name|urlencode}}</em></p>
<p>Translate a predefined key? Use {{ _(&#8220;there are {{count}} unread news&#8221;, count=skellist|length) }}. Please note that if you
get translated string/textBones, these will adapt automatically to the current language. Just print them to your template with {{ skel.name }}.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/viur.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Getting started</a><ul>
<li><a class="reference internal" href="#create-a-template">Create a template</a></li>
<li><a class="reference internal" href="#examples-for-developers">Examples for developers</a><ul>
<li><a class="reference internal" href="#add-a-more-fine-grained-access-model">Add a more fine grained access model</a></li>
<li><a class="reference internal" href="#switching-to-hierarchical-data">Switching to hierarchical Data</a></li>
<li><a class="reference internal" href="#adding-custom-functions">Adding custom functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples-for-designers-frontend-developers">Examples for designers / frontend developers</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="consistency.html" title="previous chapter">Data Consistency</a></li>
      <li>Next: <a href="bones/bones_api.html" title="next chapter">Bones</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/quickstart.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

    <script>
        
    $(document).ready(function() {
        $('#popuplogin').click(function(e) {
               e.stopPropagation();
        });
    });
    
    
        $(document).ready(function () {
            $('#hamburgericon').click(function () {
                $(".sphinxsidebarwrapper").fadeIn(100);
                $("#fcside").fadeIn(100);
                $("body").css({ overflow: 'hidden' });
            });
        });
    
        $(document).ready(function () {
            $('#fcside').click(function () {
                $("body").css({ overflow: 'inherit' });
                $(".sphinxsidebarwrapper").fadeOut(100);
                $("#fcside").fadeOut(100);
            });
        });
        
            
        var thescroll=0;
        var scrolling =false;

    function scrolleventhandler (e) {

        if( thescroll > $(window).scrollTop()){
            scrolldir=-1;
        }else{
            scrolldir=1;
        }
        thescroll=$(window).scrollTop();
        wh=parseInt($("body").css("height").replace("px", ""))

        if (scrolldir>0) {
            $('.logo').addClass("is-scrolled");
            $('.is2').addClass("is-scrolled2");
            $('.is3').addClass("is-scrolled3");
            $('.is4').addClass("is-scrolled4");
            $('.is5').addClass("is-scrolled5");
            $('.viur').addClass("is-scrolled6");
            $('.sphinxsidebarwrapper').addClass("is-scrolled7");
            
        } else {
            $('.logo').removeClass("is-scrolled");
            $('.is2').removeClass("is-scrolled2");
            $('.is3').removeClass("is-scrolled3");
            $('.is4').removeClass("is-scrolled4");
            $('.is5').removeClass("is-scrolled5");
            $('.viur').removeClass("is-scrolled6");
            $('.sphinxsidebarwrapper').removeClass("is-scrolled7");
            
        }

    }
    
	$(window).scroll(scrolleventhandler);
	$(window).resize(scrolleventhandler);
    </script>
    
    
<header class="is2">
	<div class="binding">

		<div class="logo">
			<a href="#">
				<img class="is7" src="_static/viur.png" title="ViUR - Information System">
			</a>
			<h3 class="is3">Information System</h3>
		</div>

		<div class="topnav  no-mobil">
			<ul class="topnavlist is2">
				<li>
					<a class="viur is2 is4" href="#">
						<h2 class="is5">Download</h2>
						<span class="is3">Win | Mac | Linux</span>
					</a>
				</li>
				<li>
					<a class="community is2 is4" href="#">
						<h2 class="is5">Community</h2>
						<span class="is3">Start | Help | API</span>
					</a>
				</li>
				<li>
					<a class="develop is2 is4" href="#">
						<h2 class="is5">Development</h2>
						<span class="is3">Source Code | GIT</span>
					</a>
				</li>
				<li>
					<a class="docu is2 is4" href="#">
						<h2 class="not-mobile is5">Documentation</h2>
						<h2 class="not-desktop is5">Docs</h2>
						<span class="is3">Start | Help | API</span>
					</a>
				</li>
			</ul>
		</div>

	</div>
</header>
    
    <div id="fcside"></div>
    <div class="footer">
      &copy;2015, Mausbrand Informationssysteme GmbH.
      
      | <a href="/impressum">Impressum</a> |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4a0+</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
      |
      <a href="_sources/quickstart.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>